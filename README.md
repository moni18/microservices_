# microservices_
Проект по микросервисам

PP 3.1.1 Задача
Необходимо перенести ваше CRUD-приложение на Spring Boot.

PP 3.1.2 Задача
Условие:
Склонируйте проект по ссылке и просмотрите его.
Модуль Spring Security позволяет нам внедрять права доступа, а также контролировать их исполнение без ручных проверок.
Spring Security базируется на 2х интерфейсах, которые определяют связь сущностей с секьюрностью: UserDetails и GrantedAuthority.
UserDetails - то, что будет интерпретироваться системой как пользователь.
GrantedAuthority - сущность, описывающая права юзера.
Оба эти интерфейса имеют множество реализаций: просмотрите класс WebSecurityConfig, в методе configure() с помощью настроек userDetailsService() мы собираем единственный на всю программу экземпляр UserDetails }}с именем и паролем user , а его роль "USER" так же будет преобразована в экземпляр {{GrantedAuthority.

Это простейший способ создания секьюрности. Так же мы можем использовать jdbc-аутентификацию путем написания запроса, возвращающего пользователя и роль.
Как вы понимаете, такие способы максимально просты, но лишены достаточной гибкости, потому наиболее часто используемый вариант настройки выглядит как имплементация{{ UserDetails}}и {{GrantedAuthority}} в классах-сущностях с переопределением существующих методов.

Рассмотрим приложение.
Новые классы:
WebSecurityConfig - настройка секьюрности по определенным URL, а также настройка UserDetails и GrantedAuthority.
LoginSuccessHandler -  хэндлер, содержащий в себе алгоритм действий при успешной аутентификации. Например, тут мы можем отправить пользователя с ролью админа на админку после логина, а с ролью юзер на главную страницу сайта и т.п. 

Задание:
Перенесите классы и зависимости из предыдущей задачи.
Создайте класс Role и свяжите User с ролями так, чтобы юзер мог иметь несколько ролей.
Имплементируйте модели {{Role}} и {{User}} интерфейсами {{GrantedAuthority}} и {{UserDetails}} соответственно. Измените настройку секьюрности с {{inMemory}} на {{userDetailService}}
Все CRUD-операции должны быть доступны только пользователю с ролью admin по url: /admin/. Добавление/изменение юзера должно быть с ролями за один запрос 
Пользователь с ролью user имеет доступ только по своему url /user и получать данные только о себе. Доступ к этому url должен быть только у пользователей с ролью user и admin. Не забывайте про несколько ролей у пользователя!
Настройте logout с любого url
Необходимо установить Postman/Insomnia (на выбор) и разобраться как он работает 
С помощью Postman/Insomnia протестировать все endpoints.

PP 3.1.3 Задача
Написать Rest-контроллеры для вашего приложения.
Необходимо установить Postman/Insomnia и разобраться как он работает
С помощью Postman/Insomnia протестировать все Rest endpoints.

PP 3.1.4 Задача
В рамках этой задачи мы освоим работу с Rest-template, взаимодействуя с помощью него с открытым Rest API.
Для выполнения задания необходимо:
Создать Maven проект
Включить в файл pom.xml необходимые зависимости
Описание задачи
Для работы предоставляется API по URL - *http://94.198.50.185:7081/api/users*
Ваша задача: Последовательно выполнить следующие операции и получить код для проверки на платформе:
 Получить список всех пользователей
 Когда вы получите ответ на свой первый запрос, вы должны сохранить свой session id, который получен через cookie. Вы получите его в заголовке ответа set-cookie. Поскольку все действия происходят в рамках одной сессии, все дальнейшие запросы должны использовать полученный session id ( необходимо использовать заголовок в последующих запросах )
 Сохранить пользователя с id = 3, name = James, lastName = Brown, age = на ваш выбор. В случае успеха вы получите первую часть кода.
 Изменить пользователя с id = 3. Необходимо поменять name на Thomas, а lastName на Shelby. В случае успеха вы получите еще одну часть кода.
 Удалить пользователя с id = 3. В случае успеха вы получите последнюю часть кода.
В результате выполненных операций вы должны получить итоговый код, сконкатенировав все его части. Количество символов в коде = 18.
Необходимые данные:
      Модель пользователя: __  
{{ public class User
{   private Long id;   private String name;   private String lastName;   private Byte age; ... }
}}

     Список URL для операций и типы запросов:
Получение всех пользователей - …*/api/users* ( GET )
Добавление пользователя - …/api/users ( POST )
Изменение пользователя - …*/api/users* ( PUT )
Удаление пользователя - …*/api/users* /{id} ( DELETE )

Требования:
Все операции должны проводится в рамках одной сессии ( не пытайтесь выполнить операции в ручную, например через POSTMAN, сессия имеет ограниченное время   жизни )
Все операции должны быть выполнены последовательно по условию
Для того, чтобы получить необходимый заголовок из запроса, необходимо использовать тип данных ResponseEntity ** в качестве ответа на ваш запрос.

PP 4.1 Задача
Эта задача является подготовкой к проекту!
В этой задаче ты изучишь:
Работа с Docker и контейнеризацией приложений
Работа с Keycloak
Интеграция с Keycloak:
Spring Cloud Gateway
Spring Security
Spring Validation - Валидация данных в контроллерах
Lombok - Облегченная работа с Getter, Setter, Constructor
Mapstruct - Маппинг объектов
Swagger Ui (OpenApi) - Спецификация REST API
Написание тестов Материалы по тестированию:
https://github.com/cheatsnake/backend-cheats/blob/master/README_RUS.md#тестирование
Задача: покрыть интеграционными тестами слои API (Контроллеры) и Сервис
Описание задачи находится в GitLab. Переходи по ссылке и приступай к изучению!
https://git.it-mentor.tech/vanderdt/MS
